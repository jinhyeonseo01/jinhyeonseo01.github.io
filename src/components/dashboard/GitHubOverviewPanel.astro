---
import type { Locale } from "../../i18n/config";

interface Props {
  locale: Locale;
  username: string;
  messages: Record<string, string>;
}

const { locale, username, messages } = Astro.props;
---

<section
  class="panel github-board"
  data-github-insights
  data-mode="overview"
  data-username={username}
  data-locale={locale}
  data-loading={messages.githubLoading}
  data-unavailable={messages.githubUnavailable}
  data-cached-label={messages.githubApiRemainingCached}
>
  <header class="github-board__header">
    <div>
      <h2 class="panel__title">{messages.githubTelemetryTitle}</h2>
      <p class="panel__description">{messages.githubTelemetryDescription}</p>
    </div>
    <div class="github-board__meta">
      <a class="btn btn--secondary" href={`https://github.com/${username}`} target="_blank" rel="noopener noreferrer">
        {messages.githubVisitProfile}
      </a>
      <span class="github-board__sync" data-gh-sync data-prefix={messages.githubLastSync}>
        {messages.githubLoading}
      </span>
      <span class="github-board__quota">
        <span>{messages.githubApiRemaining}</span>
        <strong data-gh-rate>--</strong>
      </span>
    </div>
  </header>

  <div class="github-metrics-grid">
    <article class="github-metric-card">
      <span class="github-metric-card__label">{messages.githubFollowers}</span>
      <strong class="github-metric-card__value" data-gh-metric="followers">--</strong>
      <span class="github-metric-card__icon" aria-hidden="true">◉</span>
    </article>
    <article class="github-metric-card">
      <span class="github-metric-card__label">{messages.githubFollowing}</span>
      <strong class="github-metric-card__value" data-gh-metric="following">--</strong>
      <span class="github-metric-card__icon" aria-hidden="true">◎</span>
    </article>
    <article class="github-metric-card">
      <span class="github-metric-card__label">{messages.githubPublicRepos}</span>
      <strong class="github-metric-card__value" data-gh-metric="repos">--</strong>
      <span class="github-metric-card__icon" aria-hidden="true">▦</span>
    </article>
    <article class="github-metric-card">
      <span class="github-metric-card__label">{messages.githubPublicGists}</span>
      <strong class="github-metric-card__value" data-gh-metric="gists">--</strong>
      <span class="github-metric-card__icon" aria-hidden="true">▤</span>
    </article>
    <article class="github-metric-card">
      <span class="github-metric-card__label">{messages.githubStars}</span>
      <strong class="github-metric-card__value" data-gh-metric="stars">--</strong>
      <span class="github-metric-card__icon" aria-hidden="true">★</span>
    </article>
    <article class="github-metric-card">
      <span class="github-metric-card__label">{messages.githubForks}</span>
      <strong class="github-metric-card__value" data-gh-metric="forks">--</strong>
      <span class="github-metric-card__icon" aria-hidden="true">⑂</span>
    </article>
    <article class="github-metric-card">
      <span class="github-metric-card__label">{messages.githubIssues}</span>
      <strong class="github-metric-card__value" data-gh-metric="issues">--</strong>
      <span class="github-metric-card__icon" aria-hidden="true">◌</span>
    </article>
    <article class="github-metric-card">
      <span class="github-metric-card__label">{messages.githubActive30d}</span>
      <strong class="github-metric-card__value" data-gh-metric="active_30d">--</strong>
      <span class="github-metric-card__icon" aria-hidden="true">⎈</span>
    </article>
  </div>

  <div class="github-board__lower">
    <section class="github-subpanel">
      <h3>{messages.githubLanguageMix}</h3>
      <div class="github-language-list" data-gh-languages>
        <p class="github-placeholder">{messages.githubLoading}</p>
      </div>
    </section>

    <section class="github-subpanel">
      <h3>{messages.githubRecentRepos}</h3>
      <div class="github-table-wrap">
        <table class="github-table">
          <thead>
            <tr>
              <th>{messages.githubRepoName}</th>
              <th>{messages.githubRepoLanguage}</th>
              <th>{messages.githubRepoStars}</th>
              <th>{messages.githubRepoForks}</th>
              <th>{messages.githubRepoUpdated}</th>
            </tr>
          </thead>
          <tbody data-gh-repos>
            <tr>
              <td colspan="5">{messages.githubLoading}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
  </div>

  <p class="github-error" data-gh-error hidden>{messages.githubUnavailable}</p>
</section>

<script is:inline type="module" src="/scripts/github-insights.js"></script>
